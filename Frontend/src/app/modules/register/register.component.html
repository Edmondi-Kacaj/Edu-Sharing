<global-progress *ngIf="isLoading"></global-progress>
<div [class.display-none]="isLoading" class="dialog darken valign-wrapper">
    <div class="card center-card card-action card-mwide">

        <div class="card-content">
            <div class="card-title">
                {{(state=='request' || state=='done-reset' ? 'REGISTER.REQUEST.TITLE' : state=='reset-password' ? 'REGISTER.RESET.TITLE' : 'REGISTER.TITLE') | translate}}
            </div>
            <div class="card-scroll">
                <app-register-form [class.display-none]="!(state=='register')" (onLoading)="isLoading=$event" (onRegisterDone)="onRegisterDone()" #registerForm></app-register-form>
                <app-register-done *ngIf="state=='done' || state=='done-reset'" (onModify)="modifyData()" [inputState]="state" #registerDone></app-register-done>
                <app-register-request *ngIf="state=='request'" (onDone)="onPasswordRequested()" (onLoading)="isLoading=$event" #request></app-register-request>
                <app-register-reset-password *ngIf="state=='reset-password'" (onLoading)="isLoading=$event" #resetPassword></app-register-reset-password>
            </div>
        </div>
        <div class="card-action">
            <a *ngIf="state=='register'" class="waves-effect waves-light btn" [class.disabled]="!registerForm || !registerForm.canRegister()" tabindex="0" (keyup.enter)="registerForm.register()" (click)="registerForm.register()">{{'REGISTER.BUTTON' | translate }}</a>
            <a *ngIf="state=='request'" [class.disabled]="!request || !request.emailFormControl.valid" tabindex="0" (keyup.enter)="requestDone(request.emailFormControl.value)" (click)="requestDone(request.emailFormControl.value)" class="waves-effect waves-light btn">{{'REGISTER.REQUEST.BUTTON' | translate }}</a>
            <a *ngIf="state=='reset-password'" [class.disabled]="!resetPassword || !resetPassword.buttonCheck()" tabindex="0" (keyup.enter)="newPassword()" (click)="newPassword()" class="waves-effect waves-light btn">{{'REGISTER.RESET.BUTTON' | translate }}</a>
            <a *ngIf="state=='done' || state=='done-reset' && registerDone" class="waves-effect waves-light btn" [class.disabled]="registerDone && !registerDone.keyInput.trim()" tabindex="0" (keyup.enter)="registerDone.activate(registerDone.keyInput)" (click)="registerDone.activate(registerDone.keyInput)">{{(status=='done' ? 'REGISTER.DONE.ACTIVATE' : 'NEXT') | translate}}</a>
            <a class="btn-flat" tabindex="0" (click)="cancel()" (keyup.enter)="cancel()">{{ 'CANCEL' | translate }}</a>
        </div>
    </div>
</div>
