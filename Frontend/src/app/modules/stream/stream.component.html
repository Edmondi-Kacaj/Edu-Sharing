<main-nav #mainNav
          [title]="'STREAM.TITLE'"
          [currentScope]="'stream'"
          [searchEnabled]="false"
          [searchPlaceholder]="'STREAM.SEARCH_PLACEHOLDER'"
          [(searchQuery)]="searchQuery"
          (onSearch)="doSearch($event)"
></main-nav>
<workspace-management
    [(addToCollection)]="collectionNodes"
></workspace-management>
<div class="stream-container" infiniteScroll
[scrollWindow]="true"
(scrolled)="onScroll()">
<div class="row">
    <div class="col m3 choose-menu-main removepadding margin-show">
            <div class="choose-menu" (click)="menuOptions('new')" [ngClass]="menuOption == 'new' ? 'm-active' : 'm-inactive'">
                <i class="tiny material-icons ">date_range</i> {{'STREAM.MENU.OPTION1' | translate }}
            </div>
            <div class="choose-menu" (click)="menuOptions('seen')" [ngClass]="menuOption == 'seen' ? 'm-active' : 'm-inactive'">
                <i class="tiny material-icons ">visibility</i> {{'STREAM.MENU.OPTION2' | translate }}
            </div>
            <!--<div class="choose-menu">
                <i class="tiny material-icons ">settings</i> {{'STREAM.MENU.OPTION3' | translate }}
            </div>-->
    </div>    
    <div class="col s12 m6 remove-horizontal-padding">
        <div class="margin-show">

        <div class="stream-header-left row stream-marginfix">
            <div *ngIf="menuOption == 'new'" class="stream-title col s10 m12">{{'STREAM.MENU.OPTION1' | translate }} <i class="small material-icons arrow-menu-arrow " (click)="toggleMenuOptions()">keyboard_arrow_down</i> </div>
            <div *ngIf="menuOption == 'seen'" class="stream-title col s10 m12">{{'STREAM.MENU.OPTION2' | translate }} <i class="small material-icons arrow-menu-arrow" (click)="toggleMenuOptions()">keyboard_arrow_down</i> </div>
            
            <span id="stream-title-date" class="stream-title-date col s12 m12">
                {{today()}}
            </span>
            <div class="arrow-menu-display mobile-menu " [ngClass]="showMenuOptions ? '' : 'hide'">
                <div class="choose-menu"  (click)="menuOptions('new')" [ngClass]="menuOption == 'new' ? 'm-active' : 'm-inactive'">
                        <i class="tiny material-icons ">date_range</i>  {{'STREAM.MENU.OPTION1' | translate }}
                </div>
                <div class="choose-menu"  (click)="menuOptions('seen')" [ngClass]="menuOption == 'seen' ? 'm-active' : 'm-inactive'">
                        <i class="tiny material-icons ">visibility</i> {{'STREAM.MENU.OPTION2' | translate }}
                </div>
                <!--<div class="choose-menu" [ngClass]="menuOption == 'seen' ? 'm-inactive' : 'm-inactive'">
                    <i class="tiny material-icons ">settings</i>  {{'STREAM.MENU.OPTION3' | translate }}
                </div>-->
            </div>
        </div>    
  
        <div *ngFor="let strm of streams" [ngClass]="strm.nodes.length === 0 ? 'hide' : 'stream-box'">
           <div class="row row-nomargin" >
                <div class="stream-box-title col s10" (click)="onStreamObjectClick(strm)"> <span *ngIf="strm.properties['add_to_stream_title']">{{ strm.properties['add_to_stream_title'] }}</span> <span *ngIf="!strm.properties['add_to_stream_title']">{{ 'STREAM.OBJECT.NOTITLE' | translate }}</span> </div>
                <div class="stream-box-main-vert col s2">
                    <actionbar
                        [numberOfAlwaysVisibleOptions]="0"
                        [numberOfAlwaysVisibleOptionsMobile]="0"
                        [style]="'flat'"
                        [options]="actionOptions"
                        [node]="strm.id"
                        (click)="checkIfEnable(strm.nodes)"
                    ></actionbar>
                </div>
            </div>
            
                <div class="stream-box-desc"><span *ngIf="strm.properties['add_to_stream_description']">{{ strm.properties['add_to_stream_description'] }}</span> <span *ngIf="!strm.properties['add_to_stream_description']">{{ 'STREAM.OBJECT.NODESCRIPTION' | translate }}</span></div>

                <div class="stream-box-kompetenzen" > <div class="chip" *ngFor="let keyword of strm.properties['cclom:general_keyword']">{{keyword}}</div> </div>

            <div class="stream-box-nonodes" *ngIf="strm.nodes.length === 0"> {{'STREAM.OBJECT.NONODES' | translate }} </div>
            <div class="stream-box-image" (click)="onStreamObjectClick(strm)" *ngIf="strm.nodes[0]"> 
                <div [ngStyle]="{ 'background': 'linear-gradient(to bottom, transparent 70%, black 115%), url(' + strm.nodes[0].preview.url + ')', 'background-size':'cover'}">
                    <img src="{{ strm.nodes[0].preview.url }} " style="width:100%;height:auto;border:0;visibility:hidden;">
                </div>
                
                <div class="bottom-left">{{strm.properties['add_to_stream_title']}}</div>
                <div class="bottom-right">{{ strm.nodes[0].commentCount }} </div>
                <div class="bottom-right-icon"><i class="material-icons stic" >comment</i> </div>
            </div>

        </div>

    </div>
    </div> <!-- cols8 -->
    <div class="col m3"></div>
</div> <!-- row -->



    <div class="create fixed-action-btn"
         *ngIf="createAllowed"
         (click)="create()"
    ><a class="btn-floating btn-large waves-effect"><i class="material-icons">add</i></a>
        <!--
      <ul>
        <li><a class="btn-floating btn-floating-inverted" (click)="showUploadSelect=true"><i class="material-icons">cloud_upload</i></a></li>
        <li><a class="btn-floating btn-floating-inverted" (click)="addFolderName=''"><i class="material-icons">create_new_folder</i></a></li>
        <li *ngFor="let connector of connectorList ? connectorList.connectors : null">
          <a class="btn-floating btn-floating-inverted" (click)="createConnectorName='';createConnectorType=connector"><i class="material-icons">{{connector.icon}}</i></a>
        </li>
        <li><a class="btn-floating btn-floating-inverted" (click)="listLTI()"><i class="material-icons">extension</i></a></li>
      </ul>
      -->
    </div>
    <div class="dialog dialogCreate" *ngIf="showCreate" (click)="showCreate=false" (contextmenu)="showCreate=false;$event.preventDefault();$event.stopPropagation();"></div>
    <!-- <input type="file" accept="image/*" capture="camera" #camera (change)="uploadCamera($event)"> -->
    <div class="createMenu collection"
         #dropdown
         [@overlay]="showCreate && connectorList"
         *ngIf="showCreate && connectorList">
        <a *ngFor="let connector of connectorList.connectors;let i=index"
           class="collection-item"
           [class.collection-item-seperate]="!i"
           tabindex="0"
           (keyup.enter)="showCreate=false;createConnectorName='';createConnectorType=connector"
           (click)="showCreate=false;createConnectorName='';createConnectorType=connector">
            <i class="material-icons">{{connector.icon}}</i> {{ 'CONNECTOR.'+connector.id+'.NAME' | translate}}<img class="connectorBeta" src="assets/images/beta.svg"></a>
        <!-- <a class="collection-item collection-item-seperate" (click)="listLTI()"><i class="material-icons">extension</i> {{ 'WORKSPACE.ADD_LTI' | translate}}</a> -->
    </div>
    <workspace-create-connector *ngIf="createConnectorName!=null"
                                [name]="createConnectorName"
                                [connector]="createConnectorType"
                                (onCancel)="createConnectorName=null"
                                (onCreate)="createConnector($event)"
    ></workspace-create-connector>
</div>
