<main-nav *ngIf="mainnav" #mainNav
          [title]="'SIDEBAR.LOGIN'"
          [currentScope]="'login'"
          [searchEnabled]="false"
></main-nav>
  <div *ngIf="!isLoading">
  <card title="{{caption | translate}}" subtitle="{{'LOGIN.SUBTITLE' | translate}}" [isCancelable]="previousStage!=null" (onCancel)="goBack()" [buttons]="buttons" width="normal" height="large">
      <spinner *ngIf="isLoading" class="center"></spinner>
      <div class="login-content" *ngIf="!isLoading">
      <div class="branding"><img src="assets/images/logo.svg" image-config alt=""></div>
          <div *ngIf="stage=='choose'" [@dialog]="stage=='choose'" class="choose">
              <div>
                  <div class="choose-label">{{'LOGIN.CHOOSE_URL' | translate}}</div>
                  <a class="btn waves-effect waves-light" (click)="openLoginUrl()" (keyup.enter)="openLoginUrl()" tabindex="0">{{'LOGIN.CHOOSE_URL_BUTTON' | translate}} <i class="material-icons">arrow_forward</i></a>
              </div>
              <div>
                  <div class="choose-label">{{'LOGIN.CHOOSE_LOCAL' | translate}}</div>
                  <a class="btn waves-effect waves-light" (click)="showLogin()" (keyup.enter)="showLogin()" tabindex="0">{{'LOGIN.CHOOSE_LOCAL_BUTTON' | translate}}</a>
              </div>
          </div>
          <div *ngIf="stage=='login'" [@dialog]="stage=='login'">
          <form (ngSubmit)="login()" #loginForm>
            <div *ngIf="showUsername">
                <mat-form-field>
                  <mat-label>{{'LOGIN.USERNAME' | translate}}</mat-label>
                  <input matInput #usernameInput required name="username" id="username" (keydown.enter)="login()" (keyup)="checkConditions()" [(ngModel)]="username" autofocus/>
                </mat-form-field>
            </div>
            <div>
                <input-password #passwordInput id="password" label="{{'LOGIN.PASSWORD' | translate}}" required="true" (keydown.enter)="login()" [(value)]="password"></input-password>
            </div>
          </form>
          <div class="register" *ngIf="config.register.local || config.register.registerUrl">
              {{'LOGIN.REGISTER_TEXT' | translate}}
              <a (click)="register()" (keyup.enter)="register()" class="focus-underline" tabindex="0">{{'LOGIN.REGISTER_LINK' | translate}} <i icon iconId="arrow_forward"></i></a>
          </div>
        </div>
    </div>
  </card>
  <powered-by mode="white" [ngClass]="{'powered-down': config.register.local || config.register.registerUrl}"></powered-by>
  </div>
